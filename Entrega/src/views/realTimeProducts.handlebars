<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Productos en Tiempo Real</h1>

        <!-- Formulario para agregar productos -->
        <form id="addProductForm" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-6">
            <div class="mb-4">
                <input
                    type="text"
                    name="title"
                    placeholder="Título"
                    required
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                />
            </div>
            <div class="mb-4">
                <input
                    type="number"
                    name="price"
                    placeholder="Precio"
                    required
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                />
            </div>
            <div class="mb-6">
                <input
                    type="text"
                    name="description"
                    placeholder="Descripción"
                    required
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                />
            </div>
            <button
                type="submit"
                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full"
            >
                Agregar producto
            </button>
        </form>

        <!-- Lista de productos -->
        {{#if products.length}}
            <ul id="productList" class="space-y-4">
                {{#each products}}
                    <li data-id="{{this.id}}" class="bg-white shadow-md rounded-lg p-4">
                        <h2 class="text-xl font-semibold text-gray-800">{{this.title}}</h2>
                        <p class="text-gray-600">Precio: ${{this.price}}</p>
                        <p class="text-gray-700">{{this.description}}</p>
                        <button
                            onclick="deleteProduct({{this.id}})"
                            class="mt-2 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                        >
                            Eliminar
                        </button>
                    </li>
                {{/each}}
            </ul>
        {{else}}
            <p class="text-center text-gray-600">No hay productos disponibles</p>
        {{/if}}
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

         socket.on('productsUpdated', (products) => {
    const productList = document.getElementById('productList');
    if (!productList) return;
    productList.innerHTML = '';
    products.forEach(product => {
      const li = document.createElement('li');
      li.innerHTML = `
        <h2>${product.title}</h2>
        <p>Precio: $${product.price}</p>
        <p>Descripción: ${product.description}</p>
      `;
      productList.appendChild(li);
    });
  });
</script>
</body>